require("./../lib/env-js/envjs/node");
require("./../d3");
require("./../d3.color");

var colors = [
  "#000000", "#333333", "#808080",
  "#cccccc", "#eeeeee", "#ffffff",
  "#ff0000", "#00ff00", "#0000ff",
  "#ffff00", "#ff00ff", "#00ffff"
];

var de00 = [
{"L1": 50.0000,"a1": 2.6772,"b1": -79.7751,"L2": 50.0000,"a2": 0.0000,"b2": -82.7485,"diff": 2.0425},
{"L1": 50.0000,"a1": 3.1571,"b1": -77.2803,"L2": 50.0000,"a2": 0.0000,"b2": -82.7485,"diff": 2.8615},
{"L1": 50.0000,"a1": 2.8361,"b1": -74.0200,"L2": 50.0000,"a2": 0.0000,"b2": -82.7485,"diff": 3.4412},
{"L1": 50.0000,"a1": -1.3802,"b1": -84.2814,"L2": 50.0000,"a2": 0.0000,"b2": -82.7485,"diff": 1.0000},
{"L1": 50.0000,"a1": -1.1848,"b1": -84.8006,"L2": 50.0000,"a2": 0.0000,"b2": -82.7485,"diff": 1.0000},
{"L1": 50.0000,"a1": -0.9009,"b1": -85.5211,"L2": 50.0000,"a2": 0.0000,"b2": -82.7485,"diff": 1.0000},
{"L1": 50.0000,"a1": 0.0000,"b1": 0.0000,"L2": 50.0000,"a2": -1.0000,"b2": 2.0000,"diff": 2.3669},
{"L1": 50.0000,"a1": -1.0000,"b1": 2.0000,"L2": 50.0000,"a2": 0.0000,"b2": 0.0000,"diff": 2.3669},
{"L1": 50.0000,"a1": 2.4900,"b1": -0.0010,"L2": 50.0000,"a2": -2.4900,"b2": 0.0009,"diff": 7.1792},
{"L1": 50.0000,"a1": 2.4900,"b1": -0.0010,"L2": 50.0000,"a2": -2.4900,"b2": 0.0010,"diff": 7.1792},
{"L1": 50.0000,"a1": 2.4900,"b1": -0.0010,"L2": 50.0000,"a2": -2.4900,"b2": 0.0011,"diff": 7.2195},
{"L1": 50.0000,"a1": 2.4900,"b1": -0.0010,"L2": 50.0000,"a2": -2.4900,"b2": 0.0012,"diff": 7.2195},
{"L1": 50.0000,"a1": -0.0010,"b1": 2.4900,"L2": 50.0000,"a2": 0.0009,"b2": -2.4900,"diff": 4.8045},
{"L1": 50.0000,"a1": -0.0010,"b1": 2.4900,"L2": 50.0000,"a2": 0.0010,"b2": -2.4900,"diff": 4.8045},
{"L1": 50.0000,"a1": -0.0010,"b1": 2.4900,"L2": 50.0000,"a2": 0.0011,"b2": -2.4900,"diff": 4.7461},
{"L1": 50.0000,"a1": 2.5000,"b1": 0.0000,"L2": 50.0000,"a2": 0.0000,"b2": -2.5000,"diff": 4.3065},
{"L1": 50.0000,"a1": 2.5000,"b1": 0.0000,"L2": 73.0000,"a2": 25.0000,"b2": -18.0000,"diff": 27.1492},
{"L1": 50.0000,"a1": 2.5000,"b1": 0.0000,"L2": 61.0000,"a2": -5.0000,"b2": 29.0000,"diff": 22.8977},
{"L1": 50.0000,"a1": 2.5000,"b1": 0.0000,"L2": 56.0000,"a2": -27.0000,"b2": -3.0000,"diff": 31.9030},
{"L1": 50.0000,"a1": 2.5000,"b1": 0.0000,"L2": 58.0000,"a2": 24.0000,"b2": 15.0000,"diff": 19.4535},
{"L1": 50.0000,"a1": 2.5000,"b1": 0.0000,"L2": 50.0000,"a2": 3.1736,"b2": 0.5854,"diff": 1.0000},
{"L1": 50.0000,"a1": 2.5000,"b1": 0.0000,"L2": 50.0000,"a2": 3.2972,"b2": 0.0000,"diff": 1.0000},
{"L1": 50.0000,"a1": 2.5000,"b1": 0.0000,"L2": 50.0000,"a2": 1.8634,"b2": 0.5757,"diff": 1.0000},
{"L1": 50.0000,"a1": 2.5000,"b1": 0.0000,"L2": 50.0000,"a2": 3.2592,"b2": 0.3350,"diff": 1.0000},
{"L1": 60.2574,"a1": -34.0099,"b1": 36.2677,"L2": 60.4626,"a2": -34.1751,"b2": 39.4387,"diff": 1.2644},
{"L1": 63.0109,"a1": -31.0961,"b1": -5.8663,"L2": 62.8187,"a2": -29.7946,"b2": -4.0864,"diff": 1.2630},
{"L1": 61.2901,"a1": 3.7196,"b1": -5.3901,"L2": 61.4292,"a2": 2.2480,"b2": -4.9620,"diff": 1.8731},
{"L1": 35.0831,"a1": -44.1164,"b1": 3.7933,"L2": 35.0232,"a2": -40.0716,"b2": 1.5901,"diff": 1.8645},
{"L1": 22.7233,"a1": 20.0904,"b1": -46.6940,"L2": 23.0331,"a2": 14.9730,"b2": -42.5619,"diff": 2.0373},
{"L1": 36.4612,"a1": 47.8580,"b1": 18.3852,"L2": 36.2715,"a2": 50.5065,"b2": 21.2231,"diff": 1.4146},
{"L1": 90.8027,"a1": -2.0831,"b1": 1.4410,"L2": 91.1528,"a2": -1.6435,"b2": 0.0447,"diff": 1.4441},
{"L1": 90.9257,"a1": -0.5406,"b1": -0.9208,"L2": 88.6381,"a2": -0.8985,"b2": -0.7239,"diff": 1.5381},
{"L1": 6.7747,"a1": -0.2908,"b1": -2.4247,"L2": 5.8714,"a2": -0.0985,"b2": -2.2286,"diff": 0.6377},
{"L1": 2.0776,"a1": 0.0795,"b1": -1.1350,"L2": 0.9033,"a2": -0.0636,"b2": -0.5514,"diff": 0.9082}
];

console.log("round trip rgb->lab->rgb:");
colors.forEach(function(c) {
  var c1 = d3.rgb(c),
      c2 = d3.lab(c).rgb(),
      dr = c1.r - c2.r,
      dg = c1.g - c2.g,
      db = c1.b - c2.b,
      cc = "clip:" + (c2.clipped ? "yes" : "no");
  console.log("  " + [c1, dr, dg, db, cc].join(" "));
});
console.log("");

console.log("ciede2000 test:");
de00.forEach(function(d) {
  var c1 = d3.lab(d.L1, d.a1, d.b1),
      c2 = d3.lab(d.L2, d.a2, d.b2)
      de = c1.de00(c2);
  console.log("  "
    + d.diff.toFixed(4) + " == " + de.toFixed(4) + "\t"
    + "("+ [d.L1, d.a1, d.b1].join(", ") + ") <> "
    + "("+ [d.L2, d.a2, d.b2].join(", ") + ")"
  );
});
console.log("");